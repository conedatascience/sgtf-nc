---
title: "Rapid Impact Analysis of B 1.1.7 Variant on the Spread of SARS-CoV-2 in North Carolina"
author: Michael DeWitt
bibliography: references.bib
date: 31 January, 2021
csl: https://raw.githubusercontent.com/citation-style-language/styles/master/apa-numeric-superscript-brackets.csl
header-includes:
   - \usepackage{float}
output:
    pdf_document
---

```{r setup, echo = FALSE, cache = FALSE, include = FALSE}
library(tidyverse)
library(data.table)
library(scico)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
theme_set(theme_bw())
```

```{r load-data}
dat_raw <- readr::read_rds(here::here("output", "simulated-evolutions.rds"))
variant_growth <- readr::read_csv(here::here("data-raw", "uk-data.csv"))
fitted_variant <- readr::read_csv(here::here("output", "fitted-uk-variant.csv"))
coefficient_fit <- readr::read_csv(here::here("output", "new-variant-coefficients.csv"))
model_params <- readr::read_csv(here::here("output", "simulation-data-parameters.csv"))
```

```{r effects}
r_reff_data <- dat_raw[["combined_wide_reff"]] %>% 
  filter(date != as.Date("2021-01-21"))
```

For correspondence: michael.dewitt@conehealth.com

## Abstract

**Background:** Several cases of the B1.1.7 variant of the SARS-CoV-2 were identified in North Carolina first on January 23, 2021 in Mecklenburg county and later in Guilford county on January 28, 2021 [@department_of_health_and_human_services_ncdhhs_2021; @noauthor_guilford_2021]. This strain has been associated with higher levels of transmissibility [@public_health_investigation_2021; @imperial42; @davies2020]. This study examines the potential impact of increased transmissibility as the B1.1.7 strain becomes more predominant given current vaccine distribution plans and the impact 

**Method:** We explored the anticipated impact on the effective reproduction number for North Carolina given the date of import. The approximate growth rate of B1.1.7 observed in the United Kingdom was fit and used to establish the estimate share of B1.1.7 in North Carolina. Using the nowcasted reproduction number, a stochastic discrete compartment model was fit with the current vaccination rates and B1.1.7 transmissibility to estimate the impact on the effective reproduction number.

**Results:** We found 

**Conclusions:** Population level surveillance data supports 

# Method

## Data

This analysis considered effective reproduction number data generated for the state of North Carolina using the @epinow2 R package following the methods specified by @rtwebsite.
Data on S-gene target failure (SGTF) observed in the United Kingdom and made available in the analysis @davies2020 were used in order to estimate proportion of anticipated B1.1.7 variant circulating.

@cevik_virology_2020


## Statistical analysis

In order to estimate the growth of B1.1.7, a hierarchical beta regression model was fit to data available from the analysis of Davies @davies2020.
These data were then used to estimate tranmissibility multiplier for day t, $\phi_t$, on the base contact rate given the days after the introduction of the new variant.

A stochastic discrete compartmental model was then used to simulate the effect of vaccinations and circulation of B1.1.7 on the effective reproduction number. 
Using case data and including multiplers to account for underascertainment of infections, the compartmental model included compartments for susceptible, exposed, infected, and removed persons in the population. 


$$
S_{t+1} = S_t - \beta \phi_{t}\frac{S_t I_t}{N_t} \\ 
$$

$$
E_{t+1} = E_t + \beta\phi_{t} \frac{S_t I_t}{N_t} - \delta E_t - Vaccinated_{t} \\
$$

$$
I_{t+1} = I_t + \delta E_t - \gamma I_t \\
$$

$$
R_{t+1} = R_t + \gamma I_t + Vaccinated_{t}
$$


# Results



```{r variantevolution, echo=FALSE, fig.width=10, fig.height=10, fig.cap = "Estimates of SGTF Evolution Used as Proxy for B1.1.7 Share of SARS-CoV-2 Variants in Circulation"}
variant_growth %>% 
  ggplot(aes(t, perc, colour = nhs_name))+
  geom_line()+
  labs(
    title = "Estimated Percentage of B1.1.7 in SARS-CoV-2 Cases",
    subtitle = "Using UK NHS SGTF Data",
    colour = "NHS England Regions"
  )+
  geom_line(data = fitted_variant, aes(t, pred), inherit.aes = FALSE, lty = "dashed", size = 1.2)+
  scale_y_continuous(name = "Percentage of B1.1.7 in Circulation", 
                     labels = scales::percent, limits = c(0,1), expand = c(0,0))+
  scale_x_continuous(name = "Days After Introduction", limits = c(0,110))+
  theme(legend.position = "top")+
  geom_label(data = filter(fitted_variant, t == 110), aes(t, pred, label = "Estimate"), inherit.aes = FALSE)+
  scale_colour_scico_d(palette = "berlin")
```



```{r effects-tab, results = "asis"} 
model_params %>% 
  mutate(`Import Date` = as.character(`Import Date`)) %>% 
  mutate_if(is.numeric, scales::comma) %>% 
  gather(metric, value, -Region) %>% 
  spread(Region, value) %>% 
  mutate(metric = factor(metric, names(model_params))) %>% 
  arrange(metric) %>% 
  knitr::kable(col.names = c("Parameter", "Guilford County", "North Carolina"),caption = "Parameters used in Discrete Stochastic Compartmental Model") %>% 
  kableExtra::kable_styling()
```


```{r echo=FALSE, fig.width=10, fig.height=10, fig.cap = "Estimates of Reproduction Number Evolution in North Carolina and Guilford County Shows Heteogenity"}
r_reff_data%>%
  filter(!is.na(Median)) %>%
  mutate(variant = ifelse(transmission_increase==1.5, "With B1.1.7", "No B1.1.7")) %>%
  ggplot(aes(date, Median, colour = as.factor(variant)))+
  geom_line()+
  geom_ribbon(aes(ymin = Lower, ymax = Upper), fill = "grey80", alpha = .2)+
  geom_hline(yintercept = 1)+
  labs(
    title = "Evolution of Reproduction Number",
    subtitle = "In North Carolina and Guilford County, Assumes 50% Transmissibility Increase",
    colour = "Variant",
    y = "Reproduction Number",
    x = NULL
  )+
  theme_bw()+
  theme(legend.position = "top")+
  facet_wrap(~region)+
  scale_colour_scico_d(palette = "berlin")
```

# Discussion


# References

<div id = 'refs'></div>


